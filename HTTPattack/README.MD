# WEB PAGE 3 minutes cooking  

## 著者のスペック  

|対象|所感|
|:----|:----|
|L1~L3|ちょっと得意かも|
|L4~L6|基本情報以下|
|Web|基本情報未満|
|DB|毎日触る|
|linux|毎週触る|
|セキュリティ全般|頑張ってる|
|Webセキュリティ|基本情報以下|

## 今回の攻撃対象レイヤ

HTTPプロトコル。  
※実際には比較的上位レイヤのL4～L7が対象。  

|レイヤ|層|OSI参照|プロトコル例（顕在箇所）|
|:----|:----|:----|:----|
|7|アプリケーション層|アプリケーション層|HTTP・SMB|
|6|アプリケーション層|プレゼンテーション層|EUC・UTF8・JPEG|
|5|アプリケーション層|セッション層|TLS|
|4|トランスポート層|トランスポート層|TCP・UDP|
|3|ネットワーク層|ネットワーク層|IP|
|2|ネットワーク・IF層|データリンク層|Ethernet・PPP|
|1|ネットワーク・IF層|物理層|RS-232・無線・光|

なんでレイヤモデルを出したかというと今回のGoalでいうところの

## Goal  

上位レイヤでのゴール  

* 任意の情報の授受  
* 任意のスクリプト/コードの実行  

下位レイヤでのゴール

* サーバ側のネットワーク・IF層への侵入
* root権限取得…etc  

## Recipe  

１．proxyサーバを建てる  
２．WEBを一通り触ってみる  
３．履歴からパラメータを渡している処理をピックアップ  
（URL、API param　など）  
４．スクリプトでパラメータを変更し、インジェクションしてみる  
５．Status 200で帰って来たパターンで、OS、DB、SQLを推測し、インジェクションする  
　　※Status 200を対象とするかは要検討  

## 実演  （3分）

## 得られた知見  

* 徳丸本はすごい
* スクリプト、コード実行はインジェクションの可能性を可能な限り排除する（標準化、フレームワークの使用。独自実装は危険。）
* 外部からの入力値の妥当性チェックをする
* インジェクションが成功した場合は、ランタイムが実行できる権限の行動が全部できる
* TLS対応が無いとザル  
* ホワイトリストなセキュリティ対策だけでなく、ブラックリストなセキュリティ対策は知っておいて損はない
